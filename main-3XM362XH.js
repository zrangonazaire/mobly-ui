import{i as K,j as Q,k as V,l as W,m as X}from"./chunk-COR3D7J6.js";import{b as T,c as k,d as P,e as H,h as O,i as U,j,k as B,l as G,m as h,n as $,p as z,q as J,r as f}from"./chunk-MRC7V7DO.js";import{Ab as d,Bb as c,D,Da as a,Ia as M,Ib as R,Jb as _,Kb as w,Mb as N,Na as u,Ob as L,Ta as b,_ as m,_a as p,aa as I,fb as n,gb as i,hb as l,o as S,r as y,rb as A,yb as F,zb as o}from"./chunk-T7KU2RMZ.js";var Y=()=>{let t=m(f),r=m(h);return t.isAuthenticated()?!0:(r.navigateByUrl("/login"),!1)};var it=(t,r,e,s)=>({"badge bg-primary":t,"badge bg-success":r,"badge bg-secondary":e,"badge bg-danger":s}),ot=t=>["/feuilles-route",t];function rt(t,r){if(t&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),w(7,"date"),i(),n(8,"td")(9,"span",21),o(10),i()(),n(11,"td")(12,"a",22),o(13,"D\xE9tails"),i()()()),t&2){let e=r.$implicit;a(2),d(e.id),a(2),c("Engin #",e.enginId,""),a(2),d(N(7,6,e.dateDepart,"dd/MM/yyyy HH:mm")),a(3),p("ngClass",_(9,it,e.statut==="planifiee",e.statut==="en cours",e.statut==="terminee",e.statut==="annulee")),a(),c(" ",e.statut," "),a(2),p("routerLink",R(14,ot,e.id))}}function at(t,r){if(t&1&&(n(0,"div",23),o(1),i()),t&2){let e=A();a(),c(" ",e.stats.alertes," alertes \xE0 traiter ")}}function st(t,r){t&1&&(n(0,"div",24),o(1," Aucune alerte en cours "),i())}var g=class t{constructor(r){this.dataService=r}stats={enginsDisponibles:0,enginsEnMission:0,missionsEnCours:0,consommationMoyenne:15.2,alertes:2};recentFeuillesRoute=[];ngOnInit(){this.dataService.getEngins().subscribe(r=>{this.stats.enginsDisponibles=r.filter(e=>e.statut==="disponible").length}),this.dataService.getEngins().pipe(y(r=>r.filter(e=>e.statut==="en mission").length)).subscribe(r=>{this.stats.enginsEnMission=r}),this.stats.missionsEnCours=this.dataService.getFeuillesRoute().filter(r=>r.statut==="en cours").length,this.recentFeuillesRoute=this.dataService.getFeuillesRoute().slice(0,5)}static \u0275fac=function(e){return new(e||t)(M(X))};static \u0275cmp=u({type:t,selectors:[["app-dashboard"]],decls:65,vars:8,consts:[["noAlert",""],[1,"container-fluid","mt-3"],[1,"row","mb-4"],[1,"col-md-4","mb-3"],[1,"card","text-white","bg-primary","h-100"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"card","text-white","bg-success","h-100"],[1,"card","text-white","bg-warning","h-100"],[1,"row"],[1,"col-md-8"],[1,"card","mb-4"],[1,"card-header"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"col-md-4"],["type","success",3,"value","max"],[1,"card"],[1,"card-header","bg-danger","text-white"],["class","alert alert-warning",4,"ngIf","ngIfElse"],[3,"ngClass"],[1,"btn","btn-sm","btn-info",3,"routerLink"],[1,"alert","alert-warning"],[1,"alert","alert-success"]],template:function(e,s){if(e&1&&(l(0,"app-navbar"),n(1,"div",1)(2,"h2"),o(3,"Tableau de bord"),i(),n(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"h5",6),o(9,"Engins disponibles"),i(),n(10,"h2",7),o(11),i()()()(),n(12,"div",3)(13,"div",8)(14,"div",5)(15,"h5",6),o(16,"Engins en mission"),i(),n(17,"h2",7),o(18),i()()()(),n(19,"div",3)(20,"div",9)(21,"div",5)(22,"h5",6),o(23,"Engins en maintenance"),i()()()()(),n(24,"div",10)(25,"div",11)(26,"div",12)(27,"div",13)(28,"h5"),o(29,"Derni\xE8res feuilles de route"),i()(),n(30,"div",5)(31,"table",14)(32,"thead")(33,"tr")(34,"th"),o(35,"ID"),i(),n(36,"th"),o(37,"Engin"),i(),n(38,"th"),o(39,"Date d\xE9part"),i(),n(40,"th"),o(41,"Statut"),i(),n(42,"th"),o(43,"Actions"),i()()(),n(44,"tbody"),b(45,rt,14,16,"tr",15),i()()()()(),n(46,"div",16)(47,"div",12)(48,"div",13)(49,"h5"),o(50,"Consommation moyenne"),i()(),n(51,"div",5)(52,"h3"),o(53),i(),l(54,"ngb-progressbar",17),n(55,"small"),o(56,"Objectif: 12 L/100km"),i()()(),n(57,"div",18)(58,"div",19)(59,"h5"),o(60,"Alertes"),i()(),n(61,"div",5),b(62,at,2,1,"div",20)(63,st,2,0,"ng-template",null,0,L),i()()()()()),e&2){let C=F(64);a(11),d(s.stats.enginsDisponibles),a(7),d(s.stats.enginsEnMission),a(27),p("ngForOf",s.recentFeuillesRoute),a(8),c("",s.stats.consommationMoyenne," L/100km"),a(),p("value",s.stats.consommationMoyenne*5)("max",100),a(8),p("ngIf",s.stats.alertes>0)("ngIfElse",C)}},dependencies:[O,T,k,P,H,Q,K,J,$,W],encapsulation:2})};var Z=[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadComponent:()=>import("./chunk-RNXYMPCZ.js").then(t=>t.LoginComponent)},{path:"",canActivate:[Y],children:[{path:"dashboard",component:g},{path:"engins",loadComponent:()=>import("./chunk-CZAWTTQ6.js").then(t=>t.EnginsComponent)},{path:"feuilles-route",loadComponent:()=>import("./chunk-MJRIUWU6.js").then(t=>t.FeuillesRouteComponent)},{path:"maintenance",loadComponent:()=>import("./chunk-MQR2AIEI.js").then(t=>t.MaintenanceListComponent)},{path:"carburant",loadComponent:()=>import("./chunk-GBYKIGOH.js").then(t=>t.CarburantComponent)},{path:"facturation",loadComponent:()=>import("./chunk-3GIG7IHB.js").then(t=>t.FacturationComponent)},{path:"suivi-gps",loadComponent:()=>import("./chunk-MGCWXON7.js").then(t=>t.GpsMapComponent)},{path:"utilisateurs",loadComponent:()=>import("./chunk-UMVGIU5W.js").then(t=>t.UtilisateursComponent)},{path:"dossiers",loadComponent:()=>import("./chunk-BVX2B4PY.js").then(t=>t.DossiersComponent)},{path:"audit",loadComponent:()=>import("./chunk-EKKRAYTQ.js").then(t=>t.AuditComponent)},{path:"parametres",loadComponent:()=>import("./chunk-4EQPF44G.js").then(t=>t.ParametresComponent)},{path:"",redirectTo:"/dashboard",pathMatch:"full"}]}];var q=(t,r)=>{let e=m(f),s=m(h),E=e.getCurrentUser()?.token;return E&&(t=t.clone({setHeaders:{Authorization:`Bearer ${E}`}})),r(t).pipe(D(x=>(x.status===401&&(e.logout(),s.navigate(["/login"])),S(()=>x))))};var tt={providers:[z(Z),I(V),j(B([q]))]};var v=class t{title="gestion-flots-ingenieurs";static \u0275fac=function(e){return new(e||t)};static \u0275cmp=u({type:t,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"main-content"]],template:function(e,s){e&1&&(n(0,"main",0),l(1,"router-outlet"),i())},dependencies:[G],encapsulation:2})};U(v,tt).catch(t=>console.error(t));
