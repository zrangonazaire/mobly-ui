import{a as X}from"./chunk-BC5EMYXE.js";import{j as K,k as Q,l as V,m as W,n as Y}from"./chunk-6LYBXNR3.js";import{b as T,c as k,d as P,e as H,h as O,i as U,j,k as B,l as G,m as h,n as $,p as z,q as J,r as f}from"./chunk-R3BXI236.js";import{$ as m,Bb as F,Cb as o,D,Db as d,Eb as c,Ga as a,La as M,Lb as R,Mb as _,Nb as w,Pb as N,Qa as u,Rb as L,Wa as v,ba as I,bb as p,ib as n,jb as i,kb as l,o as S,r as y,ub as A}from"./chunk-HC4MRZPG.js";var Z=()=>{let t=m(f),r=m(h);return t.isAuthenticated()?!0:(r.navigateByUrl("/login"),!1)};var ot=(t,r,e,s)=>({"badge bg-primary":t,"badge bg-success":r,"badge bg-secondary":e,"badge bg-danger":s}),rt=t=>["/feuilles-route",t];function at(t,r){if(t&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),w(7,"date"),i(),n(8,"td")(9,"span",21),o(10),i()(),n(11,"td")(12,"a",22),o(13,"D\xE9tails"),i()()()),t&2){let e=r.$implicit;a(2),d(e.id),a(2),c("Engin #",e.enginId,""),a(2),d(N(7,6,e.dateDepart,"dd/MM/yyyy HH:mm")),a(3),p("ngClass",_(9,ot,e.statut==="planifiee",e.statut==="en cours",e.statut==="terminee",e.statut==="annulee")),a(),c(" ",e.statut," "),a(2),p("routerLink",R(14,rt,e.id))}}function st(t,r){if(t&1&&(n(0,"div",23),o(1),i()),t&2){let e=A();a(),c(" ",e.stats.alertes," alertes \xE0 traiter ")}}function mt(t,r){t&1&&(n(0,"div",24),o(1," Aucune alerte en cours "),i())}var g=class t{constructor(r){this.dataService=r}stats={enginsDisponibles:0,enginsEnMission:0,missionsEnCours:0,consommationMoyenne:15.2,alertes:2};recentFeuillesRoute=[];ngOnInit(){this.dataService.getEngins().subscribe(r=>{this.stats.enginsDisponibles=r.filter(e=>e.statut==="disponible").length}),this.dataService.getEngins().pipe(y(r=>r.filter(e=>e.statut==="en mission").length)).subscribe(r=>{this.stats.enginsEnMission=r}),this.stats.missionsEnCours=this.dataService.getFeuillesRoute().filter(r=>r.statut==="en cours").length,this.recentFeuillesRoute=this.dataService.getFeuillesRoute().slice(0,5)}static \u0275fac=function(e){return new(e||t)(M(Y))};static \u0275cmp=u({type:t,selectors:[["app-dashboard"]],decls:66,vars:8,consts:[["noAlert",""],[1,"container-fluid","mt-3"],[1,"row","mb-4"],[1,"col-md-4","mb-3"],[1,"card","text-white","bg-primary","h-100"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"card","text-white","bg-success","h-100"],[1,"card","text-white","bg-warning","h-100"],[1,"row"],[1,"col-md-8"],[1,"card","mb-4"],[1,"card-header"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"col-md-4"],["type","success",3,"value","max"],[1,"card"],[1,"card-header","bg-danger","text-white"],["class","alert alert-warning",4,"ngIf","ngIfElse"],[3,"ngClass"],[1,"btn","btn-sm","btn-info",3,"routerLink"],[1,"alert","alert-warning"],[1,"alert","alert-success"]],template:function(e,s){if(e&1&&(l(0,"app-navbar")(1,"app-sidebar"),n(2,"div",1)(3,"h2"),o(4,"Tableau de bord"),i(),n(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"h5",6),o(10,"Engins disponibles"),i(),n(11,"h2",7),o(12),i()()()(),n(13,"div",3)(14,"div",8)(15,"div",5)(16,"h5",6),o(17,"Engins en mission"),i(),n(18,"h2",7),o(19),i()()()(),n(20,"div",3)(21,"div",9)(22,"div",5)(23,"h5",6),o(24,"Engins en maintenance"),i()()()()(),n(25,"div",10)(26,"div",11)(27,"div",12)(28,"div",13)(29,"h5"),o(30,"Derni\xE8res feuilles de route"),i()(),n(31,"div",5)(32,"table",14)(33,"thead")(34,"tr")(35,"th"),o(36,"ID"),i(),n(37,"th"),o(38,"Engin"),i(),n(39,"th"),o(40,"Date d\xE9part"),i(),n(41,"th"),o(42,"Statut"),i(),n(43,"th"),o(44,"Actions"),i()()(),n(45,"tbody"),v(46,at,14,16,"tr",15),i()()()()(),n(47,"div",16)(48,"div",12)(49,"div",13)(50,"h5"),o(51,"Consommation moyenne"),i()(),n(52,"div",5)(53,"h3"),o(54),i(),l(55,"ngb-progressbar",17),n(56,"small"),o(57,"Objectif: 12 L/100km"),i()()(),n(58,"div",18)(59,"div",19)(60,"h5"),o(61,"Alertes"),i()(),n(62,"div",5),v(63,st,2,1,"div",20)(64,mt,2,0,"ng-template",null,0,L),i()()()()()),e&2){let C=F(65);a(12),d(s.stats.enginsDisponibles),a(7),d(s.stats.enginsEnMission),a(27),p("ngForOf",s.recentFeuillesRoute),a(8),c("",s.stats.consommationMoyenne," L/100km"),a(),p("value",s.stats.consommationMoyenne*5)("max",100),a(8),p("ngIf",s.stats.alertes>0)("ngIfElse",C)}},dependencies:[O,T,k,P,H,Q,K,J,$,W,X],encapsulation:2})};var q=[{path:"",pathMatch:"full",redirectTo:"login"},{path:"login",loadComponent:()=>import("./chunk-HUOOTZD3.js").then(t=>t.LoginComponent)},{path:"",canActivate:[Z],children:[{path:"dashboard",component:g},{path:"engins",loadComponent:()=>import("./chunk-GGZJSUSG.js").then(t=>t.EnginsComponent)},{path:"feuilles-route",loadComponent:()=>import("./chunk-LTGNWK6D.js").then(t=>t.FeuillesRouteComponent)},{path:"maintenance",loadComponent:()=>import("./chunk-TXSMY36C.js").then(t=>t.MaintenanceListComponent)},{path:"carburant",loadComponent:()=>import("./chunk-36AQNOLR.js").then(t=>t.CarburantComponent)},{path:"facturation",loadComponent:()=>import("./chunk-JVJFUX6F.js").then(t=>t.FacturationComponent)},{path:"suivi-gps",loadComponent:()=>import("./chunk-RUIDAOA6.js").then(t=>t.GpsMapComponent)},{path:"utilisateurs",loadComponent:()=>import("./chunk-RKYIEQPT.js").then(t=>t.UtilisateursComponent)},{path:"dossiers",loadComponent:()=>import("./chunk-DHQUNS7O.js").then(t=>t.DossiersComponent)},{path:"audit",loadComponent:()=>import("./chunk-BF6VZAXD.js").then(t=>t.AuditComponent)},{path:"parametres",loadComponent:()=>import("./chunk-WN5E4ARM.js").then(t=>t.ParametresComponent)},{path:"",redirectTo:"/dashboard",pathMatch:"full"}]}];var tt=(t,r)=>{let e=m(f),s=m(h),E=e.getCurrentUser()?.token;return E&&(t=t.clone({setHeaders:{Authorization:`Bearer ${E}`}})),r(t).pipe(D(x=>(x.status===401&&(e.logout(),s.navigate(["/login"])),S(()=>x))))};var et={providers:[z(q),I(V),j(B([tt]))]};var b=class t{title="gestion-flots-ingenieurs";static \u0275fac=function(e){return new(e||t)};static \u0275cmp=u({type:t,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"main-content"]],template:function(e,s){e&1&&(n(0,"main",0),l(1,"router-outlet"),i())},dependencies:[G],encapsulation:2})};U(b,et).catch(t=>console.error(t));
